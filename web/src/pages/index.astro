---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getOturmaGruplari, getStrapiImageUrl } from "../lib/api";

// Build time'da oturma gruplarını çek
const oturmaGruplari = await getOturmaGruplari();
const featuredProducts = oturmaGruplari.slice(0, 4);
---

<BaseLayout title="Eroll Mobilya & Koltuk | Kaliteli Mobilya İmalatı">
  <!-- Hero Section -->
  <section class="relative min-h-[70vh] flex items-center overflow-hidden">
    <!-- Background -->
    <div class="absolute inset-0 bg-linear-to-br from-bg via-bg-alt to-muted-3">
    </div>
    <div
      class="absolute inset-0 opacity-5"
      style="background-image: url('/pattern.svg');"
    >
    </div>

    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 md:py-4">
      <div class="grid lg:grid-cols-2 lg:gap-12 gap-6 items-center">
        <div class="hero-content space-y-8">
          <div
            class="hero-badge inline-flex items-center gap-2 px-4 py-2 bg-accent/10 rounded-full"
          >
            <span class="w-2 h-2 bg-accent rounded-full animate-pulse"></span>
            <span class="text-sm font-medium text-accent-dark"
              >İmalat • Toptan • Perakende</span
            >
          </div>

          <h1
            class="text-4xl md:text-5xl lg:text-6xl font-bold leading-tight text-balance"
          >
            Evinize
            <span
              class="text-accent inline-flex flex-col h-[1.35em] overflow-hidden align-middle -mt-1"
            >
              <span class="word-rotator *:block">
                <span>Zarafet</span>
                <span>Şıklık</span>
                <span>Konfor</span>
                <span>Estetik</span>
                <span>Kalite</span>
                <span>Prestij</span>
                <span>Huzur</span>
                <span>Zarafet</span>
                <!-- Duplicate first for smooth loop -->
              </span>
            </span>
            Katıyoruz
          </h1>

          <p class="text-lg text-fg-muted max-w-lg">
            Kaliteli işçilik ve özenli tasarımlarla ürettiğimiz mobilya ve
            koltuklarla yaşam alanlarınızı güzelleştiriyoruz.
          </p>

          <div class="flex flex-wrap gap-4">
            <a
              href="/oturma-gruplari"
              class="inline-flex items-center gap-2 px-6 py-3 bg-accent text-white font-semibold rounded-lg hover:bg-accent-dark transition-all shadow-[0_4px_20px_rgba(10,9,8,0.08),0_2px_8px_rgba(10,9,8,0.04)] hover:shadow-[0_8px_40px_rgba(10,9,8,0.12),0_4px_16px_rgba(10,9,8,0.06)]"
            >
              Ürünleri İncele
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
              </svg>
            </a>
            <a
              href="/iletisim"
              class="inline-flex items-center gap-2 px-6 py-3 border-2 border-fg text-fg font-semibold rounded-lg hover:bg-fg hover:text-bg transition-all"
            >
              İletişime Geç
            </a>
          </div>
        </div>

        <div
          class="hero-gallery relative mt-8 lg:mt-0 h-[450px] lg:h-[600px] overflow-hidden -mx-4 sm:mx-0 max-md:px-2"
        >
          <div
            class="absolute top-0 left-0 right-0 h-9 bg-linear-to-b from-bg/50 to-transparent z-10 pointer-events-none"
          >
          </div>
          <div
            class="absolute bottom-0 left-0 right-0 h-9 bg-linear-to-t from-bg/50 to-transparent z-10 pointer-events-none"
          >
          </div>

          <div class="grid grid-cols-2 gap-4 lg:gap-6 h-full">
            <!-- Column 1 - Fast Scroll -->
            <div class="flex flex-col gap-4 lg:gap-6 animate-scroll-vertical">
              <img
                src="/hero1.jpg"
                class="w-full h-64 object-cover rounded-2xl shadow-lg"
                alt="Mobilya"
              />
              <img
                src="/hero2.jpg"
                class="w-full h-80 object-cover rounded-2xl shadow-lg"
                alt="Mobilya"
              />
              <img
                src="/hero3.jpg"
                class="w-full h-64 object-cover rounded-2xl shadow-lg"
                alt="Mobilya"
              />
              <img
                src="/hero1.jpg"
                class="w-full h-72 object-cover rounded-2xl shadow-lg"
                alt="Mobilya"
              />
              <!-- Duplicate set for loop -->
              <img
                src="/hero1.jpg"
                class="w-full h-64 object-cover rounded-2xl shadow-lg"
                alt="Mobilya"
              />
              <img
                src="/hero2.jpg"
                class="w-full h-80 object-cover rounded-2xl shadow-lg"
                alt="Mobilya"
              />
              <img
                src="/hero3.jpg"
                class="w-full h-64 object-cover rounded-2xl shadow-lg"
                alt="Mobilya"
              />
              <img
                src="/hero1.jpg"
                class="w-full h-72 object-cover rounded-2xl shadow-lg"
                alt="Mobilya"
              />
            </div>

            <!-- Column 2 - Slower Scroll -->
            <div
              class="flex flex-col gap-4 lg:gap-6 animate-scroll-vertical"
              style="animation-duration: 35s; transform: translateY(-30%);"
            >
              <img
                src="/hero2.jpg"
                class="w-full h-72 object-cover rounded-2xl shadow-lg"
                alt="Mobilya"
              />
              <img
                src="/hero3.jpg"
                class="w-full h-64 object-cover rounded-2xl shadow-lg"
                alt="Mobilya"
              />
              <img
                src="/hero1.jpg"
                class="w-full h-80 object-cover rounded-2xl shadow-lg"
                alt="Mobilya"
              />
              <img
                src="/hero3.jpg"
                class="w-full h-64 object-cover rounded-2xl shadow-lg"
                alt="Mobilya"
              />
              <!-- Duplicate set for loop -->
              <img
                src="/hero2.jpg"
                class="w-full h-72 object-cover rounded-2xl shadow-lg"
                alt="Mobilya"
              />
              <img
                src="/hero3.jpg"
                class="w-full h-64 object-cover rounded-2xl shadow-lg"
                alt="Mobilya"
              />
              <img
                src="/hero1.jpg"
                class="w-full h-80 object-cover rounded-2xl shadow-lg"
                alt="Mobilya"
              />
              <img
                src="/hero3.jpg"
                class="w-full h-64 object-cover rounded-2xl shadow-lg"
                alt="Mobilya"
              />
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Services Section -->
  <section class="services-section py-20 bg-bg">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="services-title text-center mb-16">
        <h2 class="text-3xl md:text-4xl font-bold mb-4">Hizmetlerimiz</h2>
        <p class="text-fg-muted max-w-2xl mx-auto">
          Mobilya sektöründe kaliteyi ön planda tutarak sizlere en iyi hizmeti
          sunuyoruz.
        </p>
      </div>

      <div class="grid md:grid-cols-3 gap-8">
        <div
          class="service-card bg-bg-alt p-8 rounded-2xl border border-muted-3 hover:border-accent transition-colors duration-300"
        >
          <div
            class="service-icon w-16 h-16 flex items-center justify-center bg-accent/10 text-accent rounded-xl mb-4"
          >
            <svg
              class="w-8 h-8"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.5"
                d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"
              ></path>
            </svg>
          </div>
          <h3 class="text-xl font-semibold mb-2">İmalat</h3>
          <p class="text-fg-muted">
            Kendi atölyemizde özenle üretilen, kaliteli malzemelerle hazırlanan
            mobilyalar.
          </p>
        </div>

        <div
          class="service-card bg-bg-alt p-8 rounded-2xl border border-muted-3 hover:border-accent transition-colors duration-300"
        >
          <div
            class="service-icon w-16 h-16 flex items-center justify-center bg-accent/10 text-accent rounded-xl mb-4"
          >
            <svg
              class="w-8 h-8"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.5"
                d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"
              ></path>
            </svg>
          </div>
          <h3 class="text-xl font-semibold mb-2">Toptan Satış</h3>
          <p class="text-fg-muted">
            Bayiler ve işletmeler için uygun fiyatlarla toptan mobilya tedariği.
          </p>
        </div>

        <div
          class="service-card bg-bg-alt p-8 rounded-2xl border border-muted-3 hover:border-accent transition-colors duration-300"
        >
          <div
            class="service-icon w-16 h-16 flex items-center justify-center bg-accent/10 text-accent rounded-xl mb-4"
          >
            <svg
              class="w-8 h-8"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.5"
                d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"
              ></path>
            </svg>
          </div>
          <h3 class="text-xl font-semibold mb-2">Perakende Satış</h3>
          <p class="text-fg-muted">
            Bireysel müşterilerimiz için showroom'umuzda geniş ürün yelpazesi.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Featured Products Section -->
  {
    featuredProducts.length > 0 && (
      <section class="products-section py-20 bg-bg-alt">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div class="products-header flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-12">
            <div>
              <h2 class="text-3xl md:text-4xl font-bold mb-2">
                Öne Çıkan Ürünler
              </h2>
              <p class="text-fg-muted">En beğenilen oturma gruplarımız</p>
            </div>
            <a
              href="/oturma-gruplari"
              class="inline-flex items-center gap-2 px-6 py-3 border-2 border-fg text-fg font-semibold rounded-lg hover:bg-fg hover:text-bg transition-all"
            >
              Tümünü Gör
              <svg
                class="w-4 h-4"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5l7 7-7 7"
                />
              </svg>
            </a>
          </div>

          <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6">
            {featuredProducts.map((product, index) => (
              <a
                href={`/oturma-gruplari/${product.slug}`}
                class="product-card block p-4 bg-bg rounded-2xl border border-muted-3 hover:border-accent transition-colors duration-300 group"
              >
                <div class="aspect-4/3 rounded-xl overflow-hidden bg-muted-3 mb-4">
                  {product.heroImage ? (
                    <img
                      src={getStrapiImageUrl(product.heroImage, "medium")}
                      alt={product.title}
                      class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
                      loading="lazy"
                    />
                  ) : (
                    <div class="w-full h-full flex items-center justify-center text-fg-muted">
                      <svg
                        class="w-12 h-12"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="1"
                          d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                        />
                      </svg>
                    </div>
                  )}
                </div>
                <h3 class="font-semibold text-lg group-hover:text-accent transition-colors">
                  {product.title}
                </h3>
                {product.summary && (
                  <p class="text-sm text-fg-muted mt-1 line-clamp-2">
                    {product.summary}
                  </p>
                )}
              </a>
            ))}
          </div>
        </div>
      </section>
    )
  }

  <!-- CTA Section -->
  <section class="cta-section py-20 bg-fg">
    <div class="cta-content max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-bg mb-6">
        Hayalinizdeki Mobilyayı Birlikte Tasarlayalım
      </h2>
      <p class="text-muted-2 text-lg mb-8 max-w-2xl mx-auto">
        Özel sipariş ve kişiselleştirilmiş tasarımlar için bizimle iletişime
        geçin.
      </p>
      <div class="flex flex-wrap justify-center gap-4">
        <a
          href="tel:+905301227623"
          class="cta-button inline-flex items-center gap-2 px-6 py-3 bg-accent text-white font-semibold rounded-lg hover:bg-accent-light transition-all"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"
            ></path>
          </svg>
          0530 122 76 23
        </a>
        <a
          href="https://wa.me/905301227623"
          target="_blank"
          rel="noopener noreferrer"
          class="cta-button inline-flex items-center gap-2 px-6 py-3 bg-[#25D366] text-white font-semibold rounded-lg hover:bg-[#128C7E] transition-all"
        >
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path
              d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"
            ></path>
          </svg>
          WhatsApp
        </a>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>

<script>
  import { animate, stagger, inView } from "motion";

  // Hero Section Animations
  const heroContent = document.querySelector(".hero-content");
  const heroImage = document.querySelector(".hero-image");
  const heroBadge = document.querySelector(".hero-badge");
  const floatingBadge = document.querySelector(".floating-badge");

  // Hero content entrance animation
  if (heroContent) {
    animate(
      heroContent,
      { opacity: [0, 1], y: [40, 0] },
      { duration: 0.8, ease: [0.25, 0.46, 0.45, 0.94] }
    );
  }

  // Hero badge pulse animation
  if (heroBadge) {
    animate(
      heroBadge,
      { opacity: [0, 1], scale: [0.8, 1] },
      { duration: 0.6, delay: 0.2, ease: "easeOut" }
    );
  }

  // Hero image slide-in animation
  if (heroImage) {
    animate(
      heroImage,
      { opacity: [0, 1], x: [60, 0] },
      { duration: 0.9, delay: 0.3, ease: [0.25, 0.46, 0.45, 0.94] }
    );
  }

  // Floating badge bounce animation
  if (floatingBadge) {
    animate(
      floatingBadge,
      { opacity: [0, 1], y: [30, 0], scale: [0.9, 1] },
      { duration: 0.7, delay: 0.6, ease: [0.34, 1.56, 0.64, 1] }
    );
  }

  // Services Section - Staggered card animations
  inView(
    ".services-section",
    (info) => {
      const target = info.target || info;
      const serviceCards = target.querySelectorAll(".service-card");
      const servicesTitle = target.querySelector(".services-title");

      // Animate title first
      if (servicesTitle) {
        animate(
          servicesTitle,
          { opacity: [0, 1], y: [30, 0] },
          { duration: 0.8, ease: "easeOut" }
        );
      }

      // Animate cards with elegant stagger and lift
      if (serviceCards.length > 0) {
        animate(
          serviceCards,
          {
            opacity: [0, 1],
            y: [50, 0], // Move up
            scale: [0.95, 1], // Subtle scale up
          },
          {
            duration: 0.9,
            delay: stagger(0.2, { startDelay: 0.2 }),
            ease: [0.22, 1, 0.36, 1], // Custom refined spring-like curve
          }
        );
      }
    },
    { margin: "-200px" }
  );

  // Featured Products Section - Scale and fade animations
  inView(
    ".products-section",
    () => {
      const productsHeader = document.querySelector(".products-header");
      const productCards = document.querySelectorAll(".product-card");

      if (productsHeader) {
        animate(
          productsHeader,
          { opacity: [0, 1], y: [30, 0] },
          { duration: 0.6, ease: "easeOut" }
        );
      }

      if (productCards.length > 0) {
        animate(
          productCards,
          { opacity: [0, 1], y: [40, 0], scale: [0.92, 1] },
          { duration: 0.7, delay: stagger(0.1), ease: [0.34, 1.56, 0.64, 1] }
        );
      }
    },
    { amount: 0.15 }
  );

  // CTA Section - Smooth entrance
  inView(
    ".cta-section",
    () => {
      const ctaContent = document.querySelector(".cta-content");
      const ctaButtons = document.querySelectorAll(".cta-button");

      if (ctaContent) {
        animate(
          ctaContent,
          { opacity: [0, 1], y: [40, 0] },
          { duration: 0.7, ease: [0.25, 0.46, 0.45, 0.94] }
        );
      }

      if (ctaButtons.length > 0) {
        animate(
          ctaButtons,
          { opacity: [0, 1], scale: [0.9, 1] },
          { duration: 0.5, delay: stagger(0.15), ease: [0.34, 1.56, 0.64, 1] }
        );
      }
    },
    { amount: 0.3 }
  );

  // Hover animations for interactive elements
  const interactiveCards = document.querySelectorAll(
    ".service-card, .product-card"
  );

  interactiveCards.forEach((card) => {
    card.addEventListener("mouseenter", () => {
      animate(
        card,
        { scale: 1.02, y: -5, boxShadow: "0 10px 30px rgba(0,0,0,0.1)" },
        { duration: 0.4, ease: [0.22, 1, 0.36, 1] }
      );
    });

    card.addEventListener("mouseleave", () => {
      animate(
        card,
        { scale: 1, y: 0, boxShadow: "0 0 0 rgba(0,0,0,0)" },
        { duration: 0.4, ease: [0.22, 1, 0.36, 1] }
      );
    });
  });

  // CTA Button hover animations
  const ctaButtons = document.querySelectorAll(".cta-button");

  ctaButtons.forEach((btn) => {
    btn.addEventListener("mouseenter", () => {
      animate(btn, { scale: 1.05 }, { duration: 0.2, ease: "easeOut" });
    });

    btn.addEventListener("mouseleave", () => {
      animate(btn, { scale: 1 }, { duration: 0.2, ease: "easeOut" });
    });
  });

  // Word Rotator Animation
  const rotator = document.querySelector(".word-rotator");
  if (rotator) {
    const wordCount = 7; // Number of unique words
    let currentIndex = 0;

    const startRotation = () => {
      setInterval(() => {
        currentIndex++;
        const totalItems = wordCount + 1; // Including duplicate
        const percentage = -1 * (currentIndex * (100 / totalItems));

        animate(
          rotator,
          { transform: `translateY(${percentage}%)` },
          { duration: 0.5, ease: [0.22, 1, 0.36, 1] }
        ).then(() => {
          if (currentIndex === wordCount) {
            currentIndex = 0;
            animate(rotator, { transform: "translateY(0%)" }, { duration: 0 });
          }
        });
      }, 2500);
    };

    setTimeout(startRotation, 1000);
  }
</script>

<style is:global>
  /* Initial hidden states for Motion animations */
  .hero-content,
  .services-title,
  .service-card,
  /* service-icon removed from here to ensure visibility */
  .products-header,
  .product-card,
  .cta-content,
  .cta-button {
    opacity: 0;
  }

  @keyframes scroll-vertical {
    from {
      transform: translateY(0);
    }
    to {
      transform: translateY(-50%);
    }
  }

  .animate-scroll-vertical {
    animation: scroll-vertical 45s linear infinite;
  }
</style>
